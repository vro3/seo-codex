<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Test Offerings Grid - SEO Codex</title>
  <style>
    body {
      font-family: system-ui, -apple-system, sans-serif;
      margin: 0;
      padding: 20px;
      background: #f5f5f5;
    }
    .test-banner {
      background: #0066cc;
      color: white;
      padding: 15px;
      margin: -20px -20px 20px -20px;
      text-align: center;
    }
    .test-info {
      background: #fff3cd;
      border: 1px solid #ffc107;
      padding: 15px;
      margin-bottom: 20px;
      border-radius: 5px;
    }
    .controls {
      background: white;
      padding: 15px;
      margin-bottom: 20px;
      border-radius: 8px;
      display: flex;
      gap: 10px;
      align-items: center;
    }
    .grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
      gap: 20px;
      margin: 20px 0;
    }
    .card {
      background: white;
      border-radius: 8px;
      overflow: hidden;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
      transition: transform 0.2s, box-shadow 0.2s;
    }
    .card:hover {
      transform: translateY(-4px);
      box-shadow: 0 4px 16px rgba(0,0,0,0.15);
    }
    .card img {
      width: 100%;
      height: 200px;
      object-fit: cover;
    }
    .card-content {
      padding: 20px;
    }
    .card h3 {
      margin: 0 0 10px 0;
      color: #0066cc;
    }
    .card .tagline {
      color: #666;
      font-style: italic;
      margin-bottom: 15px;
    }
    .card .tags {
      display: flex;
      flex-wrap: wrap;
      gap: 5px;
      margin: 15px 0;
    }
    .card .tag {
      background: #e7f3ff;
      color: #0066cc;
      padding: 3px 10px;
      border-radius: 12px;
      font-size: 0.85em;
      text-decoration: none;
    }
    .card .tag:hover {
      background: #0066cc;
      color: white;
    }
    .card .view-btn {
      display: inline-block;
      background: #0066cc;
      color: white;
      padding: 10px 20px;
      text-decoration: none;
      border-radius: 5px;
      margin-top: 15px;
    }
    .card .view-btn:hover {
      background: #0052a3;
    }
    .featured-badge {
      background: #ffc107;
      color: #000;
      padding: 5px 10px;
      border-radius: 3px;
      font-size: 0.8em;
      font-weight: 600;
      display: inline-block;
      margin-bottom: 10px;
    }
  </style>
</head>
<body>
  <div class="test-banner">
    <h1>üé≠ Test Offerings Grid</h1>
    <p>Testing Offerings Grid Loader with Local Data</p>
  </div>

  <div class="test-info">
    <h3>üìù Instructions:</h3>
    <ol>
      <li>Make sure your local server is running: <code>npm run serve</code></li>
      <li>This page loads: <code>data/shows-sample.json</code></li>
      <li>Click on any show to view details</li>
      <li>Use sort controls to reorder shows</li>
    </ol>
  </div>

  <div class="controls">
    <label for="sort"><strong>Sort by:</strong></label>
    <select id="sort" onchange="sortShows(this.value)">
      <option value="featured">Featured First</option>
      <option value="title">Alphabetical (A-Z)</option>
      <option value="title-desc">Alphabetical (Z-A)</option>
    </select>
    <span style="margin-left: auto; color: #666;">
      <span id="show-count">0</span> shows loaded
    </span>
  </div>

  <!-- Container for shows grid -->
  <div id="offerings-container" class="grid">
    <p style="text-align: center; color: #666;">Loading shows...</p>
  </div>

  <script>
    let allShows = [];

    // Configure data source
    window.SHOW_DATA_URL = "http://localhost:8000/data/shows-sample.json";

    async function loadShows() {
      try {
        const response = await fetch(window.SHOW_DATA_URL);
        if (!response.ok) throw new Error('Failed to fetch data');

        const data = await response.json();
        allShows = data.shows || [];

        document.getElementById('show-count').textContent = allShows.length;

        // Default sort: featured first
        sortShows('featured');

      } catch (error) {
        console.error('Error loading shows:', error);
        document.getElementById('offerings-container').innerHTML = `
          <div style="grid-column: 1 / -1; text-align: center; padding: 40px; color: #d32f2f;">
            <h2>‚ö†Ô∏è Error Loading Shows</h2>
            <p>${error.message}</p>
            <p style="font-size: 0.9em; color: #666;">
              Make sure your local server is running: <code>npm run serve</code>
            </p>
          </div>
        `;
      }
    }

    function sortShows(sortBy) {
      let sorted = [...allShows];

      switch(sortBy) {
        case 'featured':
          sorted.sort((a, b) => {
            if (a.featured && !b.featured) return -1;
            if (!a.featured && b.featured) return 1;
            return a.title.localeCompare(b.title);
          });
          break;
        case 'title':
          sorted.sort((a, b) => a.title.localeCompare(b.title));
          break;
        case 'title-desc':
          sorted.sort((a, b) => b.title.localeCompare(a.title));
          break;
      }

      displayShows(sorted);
    }

    function displayShows(shows) {
      const container = document.getElementById('offerings-container');

      if (shows.length === 0) {
        container.innerHTML = `
          <div style="grid-column: 1 / -1; text-align: center; padding: 40px;">
            <p>No shows found.</p>
          </div>
        `;
        return;
      }

      container.innerHTML = shows.map(show => `
        <div class="card">
          ${show.imageurl ? `
            <img src="${show.imageurl}" alt="${show.title}">
          ` : ''}
          <div class="card-content">
            ${show.featured ? '<div class="featured-badge">‚≠ê Featured</div>' : ''}
            <h3>${show.title}</h3>
            ${show.tagline ? `<p class="tagline">${show.tagline}</p>` : ''}
            <p>${show.short_description || show.meta_description || ''}</p>

            ${show.tags && show.tags.length > 0 ? `
              <div class="tags">
                ${show.tags.slice(0, 5).map(tag => `
                  <a href="test-tag-page.html?tag=${tag}" class="tag">#${tag}</a>
                `).join('')}
              </div>
            ` : ''}

            <a href="test-show-page.html?show=${show.page_slug}" class="view-btn">
              View Details ‚Üí
            </a>
          </div>
        </div>
      `).join('');
    }

    // Load shows on page load
    loadShows();
  </script>
</body>
</html>
